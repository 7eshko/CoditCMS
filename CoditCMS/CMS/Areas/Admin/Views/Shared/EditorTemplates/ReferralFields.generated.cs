#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.0
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Linq;
    using System.Net;
    using System.Text;
    using System.Web;
    using System.Web.Helpers;
    using System.Web.Mvc;
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Optimization;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    using CMS.Mvc;
    using CMS.PagesSettings.Lists;
    using CMS.ViewModels;
    
    #line 1 "..\..\Areas\Admin\Views\Shared\EditorTemplates\ReferralFields.cshtml"
    using DB.Entities;
    
    #line default
    #line hidden
    using Libs;
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Areas/Admin/Views/Shared/EditorTemplates/ReferralFields.cshtml")]
    public partial class _Areas_Admin_Views_Shared_EditorTemplates_ReferralFields_cshtml_ : CMS.Mvc.AdminViewPage<dynamic>
    {
        public _Areas_Admin_Views_Shared_EditorTemplates_ReferralFields_cshtml_()
        {
        }
        public override void Execute()
        {
WriteLiteral("\r\n");

            
            #line 3 "..\..\Areas\Admin\Views\Shared\EditorTemplates\ReferralFields.cshtml"
  
    var model = (ReferralField)WebContext.Model ?? new ReferralField();

            
            #line default
            #line hidden
WriteLiteral("\r\n<div");

WriteLiteral(" id=\"fields\"");

WriteLiteral(">\r\n    <div");

WriteLiteral(" data-bind=\"if: type()!=\'multicheckbox\' && type()!=\'select\'\"");

WriteLiteral(">\r\n        нет дополнительных настроек\r\n    </div>\r\n    <div");

WriteLiteral(" data-bind=\"if: type()==\'multicheckbox\' || type()==\'select\'\"");

WriteLiteral(">\r\n        <table>\r\n            <tr>\r\n                <td>\r\n                    <" +
"label>Список элементов:</label>\r\n                    <div");

WriteLiteral(" data-bind=\"foreach: items\"");

WriteLiteral(">\r\n                        <div>\r\n                            <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" data-bind=\"{value: id, attr: {name: \'AvailableValues[\' + $index() + \'].Id\'}}\"");

WriteLiteral(" />\r\n                            <input");

WriteLiteral(" type=\"hidden\"");

WriteLiteral(" data-bind=\"{value: $index(), attr: {name: \'AvailableValues[\' + $index() + \'].Ind" +
"ex\'}}\"");

WriteLiteral(" />\r\n                            <input");

WriteLiteral(" type=\"text\"");

WriteLiteral(" data-bind=\"{value: value, attr: {name: \'AvailableValues[\' + $index() + \'].Value\'" +
"}}\"");

WriteLiteral(" />\r\n                        </div>\r\n                    </div>\r\n                " +
"</td>\r\n                <td>\r\n                    <label>Цены:</label>\r\n         " +
"           <div");

WriteLiteral(" data-bind=\"foreach:items\"");

WriteLiteral(">\r\n                        <div>\r\n                            <input");

WriteLiteral(" data-a-sep=\" \"");

WriteLiteral(" data-a-dec=\",\"");

WriteLiteral(" data-alt-dec=\".\"");

WriteLiteral(" type=\"text\"");

WriteLiteral(" data-bind=\"{price: true, value:price,attr: {name: \'AvailableValues[\' + $index() " +
"+ \'].Price\'}}\"");

WriteLiteral(" />\r\n                            <a");

WriteLiteral(" href=\"javascript:void(0)\"");

WriteLiteral(" data-bind=\"{click: $parent.deleteItem}\"");

WriteLiteral(">\r\n                                <img");

WriteLiteral(" src=\"/Areas/Admin/Images/Default/delete.png\"");

WriteLiteral(" alt=\"Удалить\"");

WriteLiteral(" />\r\n                            </a>\r\n                        </div>\r\n          " +
"          </div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n\r\n" +
"        <input");

WriteLiteral(" type=\"button\"");

WriteLiteral(" value=\"Добавить элемент\"");

WriteLiteral(" data-bind=\"{click: addItem}\"");

WriteLiteral(@" />
    </div>
</div>




<script>
    var ValueViewModel = function (id,val,price) {
        var self = this;
        self.id = ko.observable(id);
        self.value = ko.observable(val);
        self.price = ko.observable(price);
    };
    var ViewModel = function (model) {
        var self = this;
        self.type = ko.observable(model.type);
        self.title = ko.observable(model.title);
        self.items = ko.observableArray(model.items);
        self.addItem = function () {
            self.items.push(new ValueViewModel('0',''));
        };
        self.deleteItem = function (item) {
            self.items.remove(item);
        };
    };
    ko.bindingHandlers.price = {
        init: function(element, valueAccessor, allBindingsAccessor) {
            $(element).autoNumeric('init');
        }
    };

    $(function () {

        var model = {
            type: '");

            
            #line 72 "..\..\Areas\Admin\Views\Shared\EditorTemplates\ReferralFields.cshtml"
               Write(model.Type);

            
            #line default
            #line hidden
WriteLiteral("\',\r\n            title: \'");

            
            #line 73 "..\..\Areas\Admin\Views\Shared\EditorTemplates\ReferralFields.cshtml"
                Write(model.Title);

            
            #line default
            #line hidden
WriteLiteral("\',\r\n            items: [");

            
            #line 74 "..\..\Areas\Admin\Views\Shared\EditorTemplates\ReferralFields.cshtml"
               Write(Html.Raw(string.Join(", ", model.AvailableValues.Select(value => string.Format("new ValueViewModel('{0}','{1}', '{2}')", value.Id, value.Value, value.Price ?? 0)))));

            
            #line default
            #line hidden
WriteLiteral(@"]
        };

        var vm = new ViewModel(model);

        ko.applyBindings(vm, $(""#fields"").get(0));

        $(""form"").on('change', ""select[name=Type]"", function () {
            var val = $(this).val();
            vm.type(val);
            checkPriceEditable(val);
        });
        checkPriceEditable(model.type);
    });
    checkPriceEditable = function(type) {
        //if (type != 'multicheckbox' && type != 'select')
        //{
        //    $('#price-disclaimer').remove();
        //    $('input[name=Price]').removeAttr(""readonly"");
        //    $('input[name=Price]').removeAttr(""disable"");
        //} else {
        //    var pricaeInput = $('input[name=Price]');
        //    pricaeInput.attr(""readonly"", ""readonly"");
        //    pricaeInput.attr(""disable"", ""disable"");
        //    pricaeInput.parent().append(""<div id=\""price-disclaimer\""><p>Нельзя добавить цену в элемент с множественным выбором или выбором из списка</p></div>"");
        //}
    };
</script>

");

        }
    }
}
#pragma warning restore 1591
